<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />

    <script src='/javascripts/jquery.js'></script>
    <script src='/javascripts/jquery-ui.min.js'></script>
    <script src='/javascripts/moment.min.js'></script>
    <link href='/stylesheets/jquery-ui.min.css' rel='stylesheet' />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src='/javascripts/fullcalendar.min.js'></script>
    <link href='/stylesheets/fullcalendar.css' rel='stylesheet' />
    <link href='/stylesheets/fullcalendar.print.css' rel='stylesheet' media='print' />
    <link href='/stylesheets/style.css' rel='stylesheet' />




  <script>
      $(document).ready(function() {

          var events = [];
          $('#calendar').fullCalendar({



              header: {
                  left: 'prev,next today',
                  center: 'title',
                  right: 'month,agendaWeek,agendaDay,listWeek'
              },
              defaultDate: '2016-12-02',
              navLinks: true, // can click day/week names to navigate views

              weekNumbers: true,
              weekNumbersWithinDays: true,
              weekNumberCalculation: 'ISO',
              weekNumberTitle: "W",
              allDaySlot:false,
              slotDuration: '00:30:00',
              minTime: "08:00:00",
              maxTime: "21:00:00",



              editable: true,
          })

      });
  </script>


</head>
 <body>





 <div class="upperCalWrap">



        <div id='wrap'>
            <div id="calendar"></div>

        </div>

     <div class="classList">
         <button id="myBtn">Classes</button>

         <!-- The Modal -->
         <div id="myModal" class="modal">

             <!-- Modal content -->

                 <span class="close">Ã—</span>
                 <div ng-app="myApp" ng-controller="myCtrl">
                     <div ng-repeat="x in classes" style="align:right;">
                         <input type="checkbox" id="{{x}} "name="{{x}}" ng-change="myFunc(x,$index,sts)" ng-model='sts' >{{x}}
                     </div>
                 </div>


         </div>
     </div>

     </div>




<script>
    //.fullCalendar( 'removeEvents' [, idOrFilter ] )
    var app = angular.module('myApp', []);
    app.controller('myCtrl', function($scope, $http) {
        $http.get("getClassesName")
                .then(function(response) {
                    $scope.classes = response.data;
                });
        $scope.myFunc = function(x,id, status) {
            if (status){
                console.log(id + " is " + status);
            $http.get("getClassesByName?title=" + x)
                    .then(function (response) {
                        pushEvents(response.data, id);
                    });
            }else{
                removeEvents(id);
            }
        };



    });
</script>

<script>

function pushEvents(newEvents,id) {

     for(var i = 0; i< newEvents.length; i++){

         var newObject = newEvents[i];
         newObject["id"] = id;
         console.log(JSON.stringify(newObject));
         $('#calendar').fullCalendar( 'renderEvent',newObject);
     }
}
function removeEvents(id){
    $('#calendar').fullCalendar( 'removeEvents',id );
}
</script>
<style>

    .classList{
        position: absolute;
        right:10px;
        top:10px;
    }
        /* The Modal (background) */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 100px; /* Location of the box */
        right: 10px;
        top: 10px;
        width: 400px; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(211,211,211,0.95); /* Black w/ opacity */
    }
        #myBtn{
            right:0px;
            color:blue;
            top:0px;

        }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    /* The Close Button */
    .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }
</style>
 <script>
     // Get the modal
     var modal = document.getElementById('myModal');

     // Get the button that opens the modal
     var btn = document.getElementById("myBtn");

     // Get the <span> element that closes the modal
     var span = document.getElementsByClassName("close")[0];

     // When the user clicks the button, open the modal
     btn.onclick = function() {
         modal.style.display = "block";
     }

     // When the user clicks on <span> (x), close the modal
     span.onclick = function() {
         modal.style.display = "none";
     }

     // When the user clicks anywhere outside of the modal, close it
     window.onclick = function(event) {
         if (event.target == modal) {
             modal.style.display = "none";
         }
     }
 </script>

</div>
 </body>
</html>
